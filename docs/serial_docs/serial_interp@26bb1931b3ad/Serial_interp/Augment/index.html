<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Augment (serial_interp@26bb1931b3ad.Serial_interp.Augment)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">serial_interp@26bb1931b3ad</a> &#x00BB; <a href="../index.html">Serial_interp</a> &#x00BB; Augment</nav><h1>Module <code>Serial_interp.Augment</code></h1></header><aside><p>A set of auxiliary functions to augment the original abstract syntax tree.</p></aside><dl><dt class="spec exception" id="exception-Empty_if_while_block"><a href="#exception-Empty_if_while_block" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Empty_if_while_block</span></code></dt><dd><p>Raised whenever a <code>While</code> or an <code>Ifthenelse</code> statement contains an empty program.</p></dd></dl><dl><dt class="spec exception" id="exception-Empty_prg_block"><a href="#exception-Empty_prg_block" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Empty_prg_block</span></code></dt><dd><p>Raised if the program to be augmented is empty.</p></dd></dl><dl><dt class="spec value" id="val-aug_if_block"><a href="#val-aug_if_block" class="anchor"></a><code><span class="keyword">val</span> aug_if_block : <span>if_bool_value:bool</span> <span>&#45;&gt;</span> <span>if_prg:<a href="../Ast_aug/index.html#type-program_aug">Ast_aug.program_aug</a></span> <span>&#45;&gt;</span> <span>prg:<a href="../Ast_aug/index.html#type-program_aug">Ast_aug.program_aug</a></span> <span>&#45;&gt;</span> <a href="../Ast_aug/index.html#type-program_aug">Ast_aug.program_aug</a></code></dt><dd><p>Augment a program contained inside an <code>Ifthenelse</code> statement.</p><p>This is called at runtime whenever a <code>Ifthenelse</code> statement is encountered.</p><p>An <code>If_start</code> statement containing the program where <code>Ifthenelse</code> was encountered and having <code>Ifthenelse</code> statement as current instruction is placed as the first statement of the augmented program inside the <code>Ifthenelse</code> block: this allows execution to identify the beginning of the <code>Ifthenelse</code> program block, thus allowing jumping back to the program containing the <code>Ifthenelse</code> statement during reverse execution.</p><p>An <code>If_end</code> statement containing</p><ul><li>the outside program having as the current statement the statement following the <code>Ifthenelse</code> statement containing this block;</li><li>The boolean evaluation of the containing <code>Ifthenelse</code> statement</li></ul><p>is placed as the last statement of the program inside the <code>Ifthenelse</code> block: this serves the same goal as the <code>If_start</code> statement, in a specular way.</p><p><code>If_end</code> contains <code>Ifthenelse</code>'s boolean evaluation because the boolean value must be pushed on delta's <code>If_stack</code> when exiting the <code>Ifthenelse</code> program block, in order to determine whether the <code>then</code> or the <code>else</code> branch was taken during reverse execution; the value is pushed at the end of <code>Ifthenelse</code>'s program execution rather than at the beginning, in order to allow nested <code>Ifthenelse</code>s to take place while pushing boolean evaluations in the correct order.</p><dl><dt>parameter if_bool_value</dt><dd><p>The boolean evaluation in <code>Ifthenelse</code> statement, which establishes whether the <code>then</code> or the <code>else</code> branch has been taken.</p></dd></dl><dl><dt>parameter if_prg</dt><dd><p>The program contained inside the <code>Ifthenelse</code> statement to be augmented.</p></dd></dl><dl><dt>parameter prg</dt><dd><p>The program containing the <code>Ifthenelse</code> statement under examination, which gets put inside <code>If_start</code> (as-is, having <code>Ifthenelse</code> as the current statement) and <code>If_end</code> (setting as the current statement the statement following <code>Ifthenelse</code>).</p></dd></dl><dl><dt>returns</dt><dd><p>The augmented <code>Ifthenelse</code> program block.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-aug_while_block"><a href="#val-aug_while_block" class="anchor"></a><code><span class="keyword">val</span> aug_while_block : <span>while_bool_expr:<a href="../Ast/index.html#type-bool_expr">Ast.bool_expr</a></span> <span>&#45;&gt;</span> <span>while_prg:<a href="../Ast_aug/index.html#type-program_aug">Ast_aug.program_aug</a></span> <span>&#45;&gt;</span> <span>while_in_outer_prg:<a href="../Ast_aug/index.html#type-program_aug">Ast_aug.program_aug</a></span> <span>&#45;&gt;</span> <a href="../Ast_aug/index.html#type-program_aug">Ast_aug.program_aug</a></code></dt><dd><p>Augment a program contained inside a <code>While</code> block.</p><p>This is called at runtime whenever a <code>While</code> statement is encountered.</p><p>A <code>While_start</code> statement containing the <code>While</code> container-program having the <code>While</code> statement as current instruction is placed as the first statement of the augmented program inside the <code>While</code> block: this allows execution to identify the beginning of the <code>While</code> program block, thus allowing</p><ul><li>Forward iterating from the beginning of the program block;</li><li>Reverse iterating, starting back from While_end when <code>While_start</code> is encountered;</li><li>Jumping back to the program containing the <code>While</code> statement during reverse execution, when there are no more iterations to be executed.</li></ul><p>A <code>While_end</code> statement containing</p><ul><li>The boolean expression of the containing <code>While</code> statement;</li><li>the outside program having as the current statement the statement coming after the <code>While</code> statement containing this block</li></ul><p>is placed as the last statement of the program inside the <code>While</code> block: this serves the same goal as the <code>While_start</code> statement, in a specular way.</p><p><code>While_end</code> contains <code>While</code>'s boolean expression because it must be re-evaluated at the end of every iteration during forward execution to decide whether to continue iterating or not; on the other hand, <code>While_start</code> doesn't need it, because reverse execution pops boolean elements from delta's <code>If_stack</code> to determine how many iterations must be performed.</p><dl><dt>parameter while_bool_expr</dt><dd><p>The boolean expression in <code>While</code> statement, to decide whether we should continue iterating or not.</p></dd></dl><dl><dt>parameter while_prg</dt><dd><p>The program contained inside the <code>While</code> statement to be augmented.</p></dd></dl><dl><dt>parameter while_in_outer_prg</dt><dd><p>The program containing the <code>While</code> statement under examination, which gets put inside <code>While_start</code> (as-is, having <code>While</code> as the current statement) and <code>While_end</code> (setting as the current statement the statement following <code>While</code>).</p></dd></dl><dl><dt>returns</dt><dd><p>The augmented <code>While</code> program block.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-aug_if_while_in_list"><a href="#val-aug_if_while_in_list" class="anchor"></a><code><span class="keyword">val</span> aug_if_while_in_list : <a href="../Ast/index.html#type-program">Ast.program</a> <span>&#45;&gt;</span> <a href="../Ast_aug/index.html#type-program_aug">Ast_aug.program_aug</a></code></dt><dd><p>Augment a program inside an <code>Ifthenelse</code> or <code>While</code> block. This is an auxiliary function for <a href="index.html#val-aug_stmt"><code>aug_stmt</code></a>, so refer to its description for details.</p></dd></dl><dl><dt class="spec value" id="val-aug_stmt"><a href="#val-aug_stmt" class="anchor"></a><code><span class="keyword">val</span> aug_stmt : <span>s:<a href="../Ast/index.html#type-stmt">Ast.stmt</a></span> <span>&#45;&gt;</span> <a href="../Ast_aug/index.html#type-stmt_aug">Ast_aug.stmt_aug</a></code></dt><dd><p>Augment a statement.</p><p>All statements are unaffected, except for <code>Ifthenelse</code> and <code>While</code> which contain program blocks which must be recursively augmented as well.</p><p>Unlike the main program, <code>If_start</code>/<code>If_end</code> and <code>While_start</code>/<code>While_end</code> boundaries aren't put at this stage; instead, they get added at runtime, since they all contain the containing augmented program where <code>If</code>/<code>While</code> statement has been encountered as a parameter (which hasn't been fully constructed yet at this stage).</p><dl><dt>parameter s</dt><dd><p>The statement to be augmented.</p></dd></dl><dl><dt>returns</dt><dd><p>The augmented statement.</p></dd></dl><dl><dt>raises Empty_if_while_block</dt><dd><p>in case a program contained inside a <code>While</code> block or inside either of an <code>Ifthenelse</code> <b>then</b> or an <b>else</b> branch block is empty.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-aug_prg"><a href="#val-aug_prg" class="anchor"></a><code><span class="keyword">val</span> aug_prg : <span>prg:<a href="../Ast/index.html#type-program">Ast.program</a></span> <span>&#45;&gt;</span> <a href="../Ast_aug/index.html#type-program_aug">Ast_aug.program_aug</a></code></dt><dd><p>Augment a program (by representing it as a zipper structure, among the other things) and its statements.</p><p>Also, put <code>Program_start</code> statement at the beginning and <code>Program_end</code> at the end of the program, in order to set the whole program's boundaries.</p><dl><dt>parameter prg</dt><dd><p>The program to be augmented.</p></dd></dl><dl><dt>returns</dt><dd><p>The augmented program.</p></dd></dl><dl><dt>raises Empty_prg_block</dt><dd><p>when the program to augment (<code>prg</code>) is empty.</p></dd></dl></dd></dl></div></body></html>