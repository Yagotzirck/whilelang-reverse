<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Interpreter (par_interp@26bb1931b3ad.Par_interp.Interpreter)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">par_interp@26bb1931b3ad</a> &#x00BB; <a href="../index.html">Par_interp</a> &#x00BB; Interpreter</nav><h1>Module <code>Par_interp.Interpreter</code></h1></header><aside><p>Interpreter for the parallel version of the while language.</p></aside><dl><dt class="spec exception" id="exception-Assignment_to_non_var"><a href="#exception-Assignment_to_non_var" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Assignment_to_non_var</span> <span class="keyword">of</span> string</code></dt><dt class="spec exception" id="exception-Illegal_statement_fwd_execution"><a href="#exception-Illegal_statement_fwd_execution" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Illegal_statement_fwd_execution</span> <span class="keyword">of</span> string</code></dt><dt class="spec exception" id="exception-Illegal_statement_rev_execution"><a href="#exception-Illegal_statement_rev_execution" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Illegal_statement_rev_execution</span> <span class="keyword">of</span> string</code></dt></dl><dl><dt class="spec value" id="val-sem_int"><a href="#val-sem_int" class="anchor"></a><code><span class="keyword">val</span> sem_int : <span>expr:<a href="../Ast/index.html#type-int_expr">Ast.int_expr</a></span> <span>&#45;&gt;</span> <span>s:<a href="../Sigma/index.html#type-sigma">Sigma.sigma</a></span> <span>&#45;&gt;</span> int</code></dt><dd><p>Integer semantics' definition.</p><dl><dt>parameter expr</dt><dd><p>The integer expression to evaluate.</p></dd></dl><dl><dt>parameter s</dt><dd><p>The sigma store (used in case the expression contains variables whose value must be retrieved.)</p></dd></dl><dl><dt>returns</dt><dd><p>The integer value resulting from the expression's evaluation.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-assign_var_fwd"><a href="#val-assign_var_fwd" class="anchor"></a><code><span class="keyword">val</span> assign_var_fwd : <span>e1:<a href="../Ast/index.html#type-int_expr">Ast.int_expr</a></span> <span>&#45;&gt;</span> <span>e2:<a href="../Ast/index.html#type-int_expr">Ast.int_expr</a></span> <span>&#45;&gt;</span> <span>state:<a href="../State/index.html#type-state">State.state</a></span> <span>&#45;&gt;</span> <a href="../State/index.html#type-state">State.state</a></code></dt><dd><p>Performs forward execution's destructive assignment:</p><ol><li>Evaluates <code>e1</code>, making sure it's a variable;</li><li>Evaluates <code>e2</code>;</li><li>Assigns <code>e2</code>'s evaluation to the variable specified by <code>e1</code>, and returns the state with the above changes applied (see <a href="../State/index.html#val-dassign_fwd"><code>State.dassign_fwd</code></a> for details such as pushing the previous value in the delta store before performing the assignment.)</li></ol><dl><dt>parameter e1</dt><dd><p>The expression containing the variable to which we must assign the new value.</p></dd></dl><dl><dt>parameter e2</dt><dd><p>The expression containing the value to assign.</p></dd></dl><dl><dt>parameter state</dt><dd><p>The state where the assignment must be performed.</p></dd></dl><dl><dt>returns</dt><dd><p>The new state where the assignment has been performed.</p></dd></dl><dl><dt>raises Assignment_to_non_var</dt><dd><p>if <code>e1</code>'s evaluation isn't a variable/identifier.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-assign_var_rev"><a href="#val-assign_var_rev" class="anchor"></a><code><span class="keyword">val</span> assign_var_rev : <span>e1:<a href="../Ast/index.html#type-int_expr">Ast.int_expr</a></span> <span>&#45;&gt;</span> <span>state:<a href="../State/index.html#type-state">State.state</a></span> <span>&#45;&gt;</span> <a href="../State/index.html#type-state">State.state</a></code></dt><dd><p>Performs reverse execution's destructive assignment:</p><ol><li>Evaluates <code>e1</code>, making sure it's a variable <code>ide</code>;</li><li>Assigns <code>ide</code>'s previous value to <code>ide</code> and returns the state with the above changes applied (see <a href="../State/index.html#val-dassign_rev"><code>State.dassign_rev</code></a> for details such as popping <code>ide</code>'s previous value from the delta store.)</li></ol><dl><dt>parameter e1</dt><dd><p>The expression containing the variable to which we must assign the previous value.</p></dd></dl><dl><dt>parameter state</dt><dd><p>The state where the assignment must be performed.</p></dd></dl><dl><dt>returns</dt><dd><p>The new state where the assignment has been performed.</p></dd></dl><dl><dt>raises Assignment_to_non_var</dt><dd><p>if <code>e1</code>'s evaluation isn't a variable/identifier.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-cadd"><a href="#val-cadd" class="anchor"></a><code><span class="keyword">val</span> cadd : <span>e1:<a href="../Ast/index.html#type-int_expr">Ast.int_expr</a></span> <span>&#45;&gt;</span> <span>e2:<a href="../Ast/index.html#type-int_expr">Ast.int_expr</a></span> <span>&#45;&gt;</span> <span>state:<a href="../State/index.html#type-state">State.state</a></span> <span>&#45;&gt;</span> <a href="../State/index.html#type-state">State.state</a></code></dt><dd><p>Performs constructive sum:</p><ol><li>Evaluates <code>e1</code>, making sure it's a variable;</li><li>Evaluates <code>e2</code>;</li><li>Sums <code>e2</code>'s evaluation to the variable specified by <code>e1</code>, and returns the state with the above changes applied (see <a href="../State/index.html#val-cadd"><code>State.cadd</code></a> for details.)</li></ol><dl><dt>parameter e1</dt><dd><p>The expression containing the variable to which we must add <code>e2</code>'s evaluation</p></dd></dl><dl><dt>parameter e2</dt><dd><p>The expression containing the value to add to the variable specified by <code>e1</code>.</p></dd></dl><dl><dt>parameter state</dt><dd><p>The state where the sum must be performed.</p></dd></dl><dl><dt>returns</dt><dd><p>The new state where the sum has been performed.</p></dd></dl><dl><dt>raises Assignment_to_non_var</dt><dd><p>if <code>e1</code>'s evaluation isn't a variable/identifier.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-csub"><a href="#val-csub" class="anchor"></a><code><span class="keyword">val</span> csub : <span>e1:<a href="../Ast/index.html#type-int_expr">Ast.int_expr</a></span> <span>&#45;&gt;</span> <span>e2:<a href="../Ast/index.html#type-int_expr">Ast.int_expr</a></span> <span>&#45;&gt;</span> <span>state:<a href="../State/index.html#type-state">State.state</a></span> <span>&#45;&gt;</span> <a href="../State/index.html#type-state">State.state</a></code></dt><dd><p>Performs constructive subtraction:</p><ol><li>Evaluates <code>e1</code>, making sure it's a variable;</li><li>Evaluates <code>e2</code>;</li><li>Subtracts <code>e2</code>'s evaluation from the variable specified by <code>e1</code>, and returns the state with the above changes applied (see <a href="../State/index.html#val-csub"><code>State.csub</code></a> for details.)</li></ol><dl><dt>parameter e1</dt><dd><p>The expression containing the variable from which we must subtract <code>e2</code>'s evaluation</p></dd></dl><dl><dt>parameter e2</dt><dd><p>The expression containing the value to subtract from the variable specified by <code>e1</code>.</p></dd></dl><dl><dt>parameter state</dt><dd><p>The state where the subtraction must be performed.</p></dd></dl><dl><dt>returns</dt><dd><p>The new state where the subtraction has been performed.</p></dd></dl><dl><dt>raises Assignment_to_non_var</dt><dd><p>if <code>e1</code>'s evaluation isn't a variable/identifier.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-exec_par_fwd"><a href="#val-exec_par_fwd" class="anchor"></a><code><span class="keyword">val</span> exec_par_fwd : <a href="../Ast_ann/index.html#type-program_ann">Ast_ann.program_ann</a> <span>&#45;&gt;</span> <a href="../Ast_ann/index.html#type-program_ann">Ast_ann.program_ann</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="../State/index.html#type-state">State.state</a> <span>&#45;&gt;</span> <a href="../State/index.html#type-state">State.state</a></code></dt><dd><p>Evaluates the <code>Par</code> statement in forward execution mode.</p><p>After annotating the <code>Par</code> statement with the current statement counter, the thread where the <code>Par</code> statement has been encountered is moved to the list of waiting threads and two new child threads (each containing a program taken from the <code>Par</code> statement) are created in the list of running threads: the resulting state is returned.</p></dd></dl><dl><dt class="spec value" id="val-exec_par_rev"><a href="#val-exec_par_rev" class="anchor"></a><code><span class="keyword">val</span> exec_par_rev : <a href="../Ast_ann/index.html#type-program_ann">Ast_ann.program_ann</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="../State/index.html#type-state">State.state</a> <span>&#45;&gt;</span> <a href="../State/index.html#type-state">State.state</a></code></dt><dd><p>Evaluates the <code>Par</code> statement in reverse execution mode.</p><p>Basically, what's happening here is that the thread where the <code>Par</code> statement has been encountered is moved back to the waiting threads, and the child thread which terminated last is re-created by retrieving its program from the <code>Par</code> statement itself.</p></dd></dl><dl><dt class="spec value" id="val-sem_stmt_fwd"><a href="#val-sem_stmt_fwd" class="anchor"></a><code><span class="keyword">val</span> sem_stmt_fwd : int <span>&#45;&gt;</span> <a href="../State/index.html#type-state">State.state</a> <span>&#45;&gt;</span> <a href="../State/index.html#type-state">State.state</a></code></dt><dd><p>Given a thread ID and a state, performs a single evaluation step in forward execution mode in the program associated to the given thread ID, and returns the resulting state.</p></dd></dl><dl><dt class="spec value" id="val-sem_stmt_rev"><a href="#val-sem_stmt_rev" class="anchor"></a><code><span class="keyword">val</span> sem_stmt_rev : <a href="../State/index.html#type-state">State.state</a> <span>&#45;&gt;</span> <a href="../State/index.html#type-state">State.state</a></code></dt><dd><p>Given a state, performs a single evaluation step in reverse execution mode by retrieving the last statement previously executed in forward execution mode, and returns the resulting state.</p></dd></dl><dl><dt class="spec value" id="val-sem_prg_fwd"><a href="#val-sem_prg_fwd" class="anchor"></a><code><span class="keyword">val</span> sem_prg_fwd : int <span>&#45;&gt;</span> <a href="../State/index.html#type-state">State.state</a> <span>&#45;&gt;</span> <a href="../State/index.html#type-state">State.state</a></code></dt><dd><p>Given a thread ID and a state, evaluates all statements in forward execution mode until the end of the program contained in the specified thread, and returns the resulting state (in other words, it executes the whole program contained in the specified thread.)</p></dd></dl><dl><dt class="spec value" id="val-sem_prg_rev"><a href="#val-sem_prg_rev" class="anchor"></a><code><span class="keyword">val</span> sem_prg_rev : <a href="../State/index.html#type-state">State.state</a> <span>&#45;&gt;</span> <a href="../State/index.html#type-state">State.state</a></code></dt><dd><p>Given a state, evaluates all statements until the beginning of the program in reverse execution mode and returns the resulting state.</p></dd></dl><dl><dt class="spec value" id="val-sem_prg_fwd_steps"><a href="#val-sem_prg_fwd_steps" class="anchor"></a><code><span class="keyword">val</span> sem_prg_fwd_steps : int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="../State/index.html#type-state">State.state</a> <span>&#45;&gt;</span> <a href="../State/index.html#type-state">State.state</a></code></dt><dd><p>Given a thread ID <code>tid</code>, a specified <code>num_steps</code> integer and a state <code>curr_state</code>, let <code>remaining_stmts</code> be the number of statements between the current statement in <code>tid</code>'s program and the <code>Program_end</code> / <code>Par_prg_end</code> boundary statement; then the function performs min(<code>remaining_stmts</code>, <code>num_steps</code>) statement evaluations in forward execution mode and returns the resulting state.</p><p>If <code>num_steps</code> &lt;= 0, <code>curr_state</code> is returned unaltered.</p></dd></dl><dl><dt class="spec value" id="val-sem_prg_rev_steps"><a href="#val-sem_prg_rev_steps" class="anchor"></a><code><span class="keyword">val</span> sem_prg_rev_steps : int <span>&#45;&gt;</span> <a href="../State/index.html#type-state">State.state</a> <span>&#45;&gt;</span> <a href="../State/index.html#type-state">State.state</a></code></dt><dd><p>Given a specified <code>num_steps</code> integer and a state <code>curr_state</code>, let <code>remaining_stmts</code> be the number of statements between the current statement in <code>curr_state</code>'s program and the <code>Program_start</code> boundary statement; then the function performs min(<code>remaining_stmts</code>, <code>num_steps</code>) statement evaluations in reverse execution mode and returns the resulting state.</p><p>If <code>num_steps</code> &lt;= 0, <code>curr_state</code> is returned unaltered.</p></dd></dl></div></body></html>